<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../declarative-workload-module/ rel=prev><link href=../caliper-monitors/ rel=next><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.6.0, mkdocs-material-9.5.28"><title>Rate Controllers - Hyperledger Caliper</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#fixed-rate class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest version. <a href=../../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Hyperledger Caliper" class="md-header__button md-logo" aria-label="Hyperledger Caliper" data-md-component=logo> <img src=../../_static/caliper.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Hyperledger Caliper </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Rate Controllers </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hyperledger/caliper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hyperledger/caliper </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Introduction </a> </li> <li class=md-tabs__item> <a href=../../overview/installing-caliper/ class=md-tabs__link> Overview </a> </li> <li class=md-tabs__item> <a href=../../connector-configuration/ethereum-config/ class=md-tabs__link> Ethereum Configuration </a> </li> <li class=md-tabs__item> <a href=../../connector-configuration/fabric-config/ class=md-tabs__link> Fabric Configuration </a> </li> <li class=md-tabs__item> <a href=../../connector-configuration/fisco-config/ class=md-tabs__link> FISCO BCOS Configuration </a> </li> <li class=md-tabs__item> <a href=../../fabric-tutorial/ class=md-tabs__link> Tutorials </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../writing-connectors/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../general/contributing/ class=md-tabs__link> General </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Hyperledger Caliper" class="md-nav__button md-logo" aria-label="Hyperledger Caliper" data-md-component=logo> <img src=../../_static/caliper.svg alt=logo> </a> Hyperledger Caliper </label> <div class=md-nav__source> <a href=https://github.com/hyperledger/caliper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hyperledger/caliper </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Overview </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Overview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../overview/installing-caliper/ class=md-nav__link> <span class=md-ellipsis> Installing and Running Caliper </span> </a> </li> <li class=md-nav__item> <a href=../../overview/bench-config/ class=md-nav__link> <span class=md-ellipsis> Benchmark Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../overview/workload-module/ class=md-nav__link> <span class=md-ellipsis> Workload Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../overview/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../connector-configuration/ethereum-config/ class=md-nav__link> <span class=md-ellipsis> Ethereum Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../connector-configuration/fabric-config/ class=md-nav__link> <span class=md-ellipsis> Fabric Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../connector-configuration/fisco-config/ class=md-nav__link> <span class=md-ellipsis> FISCO BCOS Configuration </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../fabric-tutorial/ class="md-nav__link "> <span class=md-ellipsis> Tutorials </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../fabric-tutorial/tutorials-fabric-existing/ class=md-nav__link> <span class=md-ellipsis> Existing Fabric Tutorials </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../writing-connectors/ class=md-nav__link> <span class=md-ellipsis> Writing Connectors </span> </a> </li> <li class=md-nav__item> <a href=../runtime-config/ class=md-nav__link> <span class=md-ellipsis> Runtime Configuration </span> </a> </li> <li class=md-nav__item> <a href=../declarative-workload-module/ class=md-nav__link> <span class=md-ellipsis> Declarative Workloads </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Rate Controllers </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Rate Controllers </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#fixed-rate class=md-nav__link> <span class=md-ellipsis> Fixed rate </span> </a> <nav class=md-nav aria-label="Fixed rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#fixed-feedback-rate class=md-nav__link> <span class=md-ellipsis> Fixed feedback rate </span> </a> </li> <li class=md-nav__item> <a href=#fixed-load class=md-nav__link> <span class=md-ellipsis> Fixed Load </span> </a> <nav class=md-nav aria-label="Fixed Load"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_1 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#maximum-rate class=md-nav__link> <span class=md-ellipsis> Maximum rate </span> </a> <nav class=md-nav aria-label="Maximum rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_2 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linear-rate class=md-nav__link> <span class=md-ellipsis> Linear rate </span> </a> <nav class=md-nav aria-label="Linear rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_3 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#composite-rate class=md-nav__link> <span class=md-ellipsis> Composite rate </span> </a> <nav class=md-nav aria-label="Composite rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_4 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#zero-rate class=md-nav__link> <span class=md-ellipsis> Zero rate </span> </a> <nav class=md-nav aria-label="Zero rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_5 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#record-rate class=md-nav__link> <span class=md-ellipsis> Record rate </span> </a> </li> <li class=md-nav__item> <a href=#replay-rate class=md-nav__link> <span class=md-ellipsis> Replay rate </span> </a> <nav class=md-nav aria-label="Replay rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#about-the-recordings class=md-nav__link> <span class=md-ellipsis> About the recordings: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adding-custom-controllers class=md-nav__link> <span class=md-ellipsis> Adding Custom Controllers </span> </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../caliper-monitors/ class=md-nav__link> <span class=md-ellipsis> Resource and Transaction Monitors </span> </a> </li> <li class=md-nav__item> <a href=../caliper-messengers/ class=md-nav__link> <span class=md-ellipsis> Messengers </span> </a> </li> <li class=md-nav__item> <a href=../benchmark-generators/ class=md-nav__link> <span class=md-ellipsis> Benchmark Generators </span> </a> </li> <li class=md-nav__item> <a href=../logging-control/ class=md-nav__link> <span class=md-ellipsis> Logging Control </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> General </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> General </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../general/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../general/faq/ class=md-nav__link> <span class=md-ellipsis> Caliper FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../general/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#fixed-rate class=md-nav__link> <span class=md-ellipsis> Fixed rate </span> </a> <nav class=md-nav aria-label="Fixed rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#fixed-feedback-rate class=md-nav__link> <span class=md-ellipsis> Fixed feedback rate </span> </a> </li> <li class=md-nav__item> <a href=#fixed-load class=md-nav__link> <span class=md-ellipsis> Fixed Load </span> </a> <nav class=md-nav aria-label="Fixed Load"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_1 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#maximum-rate class=md-nav__link> <span class=md-ellipsis> Maximum rate </span> </a> <nav class=md-nav aria-label="Maximum rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_2 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linear-rate class=md-nav__link> <span class=md-ellipsis> Linear rate </span> </a> <nav class=md-nav aria-label="Linear rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_3 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#composite-rate class=md-nav__link> <span class=md-ellipsis> Composite rate </span> </a> <nav class=md-nav aria-label="Composite rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_4 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#zero-rate class=md-nav__link> <span class=md-ellipsis> Zero rate </span> </a> <nav class=md-nav aria-label="Zero rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#options-and-use_5 class=md-nav__link> <span class=md-ellipsis> Options and use </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#record-rate class=md-nav__link> <span class=md-ellipsis> Record rate </span> </a> </li> <li class=md-nav__item> <a href=#replay-rate class=md-nav__link> <span class=md-ellipsis> Replay rate </span> </a> <nav class=md-nav aria-label="Replay rate"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#about-the-recordings class=md-nav__link> <span class=md-ellipsis> About the recordings: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adding-custom-controllers class=md-nav__link> <span class=md-ellipsis> Adding Custom Controllers </span> </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Rate Controllers</h1> <p>The rate at which transactions are input to the blockchain system is a key factor within performance tests. It may be desired to send transactions at a specified rate or follow a specified profile. Caliper permits the specification of custom rate controllers to enable a user to perform testing under a custom loading mechanism. A user may specify their own rate controller or use one of the default options:</p> <ul> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#fixed-rate>Fixed rate</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#fixed-feedback-rate>Fixed feedback rate</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#fixed-load>Fixed load</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#maximum-rate>Maximum rate</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#linear-rate>Linear rate</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#composite-rate>Composite rate</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#zero-rate>Zero rate</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#record-rate>Record rate</a></li> <li><a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#replay-rate>Replay rate</a></li> </ul> <p>For implementing your own rate controller, refer to the <a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#adding-custom-controllers>Adding Custom Controllers</a> section.</p> <h2 id=fixed-rate>Fixed rate<a class=headerlink href=#fixed-rate title="Permanent link">&para;</a></h2> <p>The fixed rate controller is the most basic controller, and also the default option if no controller is specified. It will send input transactions at a fixed interval that is specified as TPS (transactions per second).</p> <h3 id=options-and-use>Options and use<a class=headerlink href=#options-and-use title="Permanent link">&para;</a></h3> <p>The fixed-rate controller can be specified by setting the rate controller <code>type</code> to the <code>fixed-rate</code> string.</p> <p>Controller options include:</p> <ul> <li><code>tps</code>: the rate at which transactions are cumulatively sent to the SUT by all workers</li> </ul> <p>The fixed rate controller, driving at 10 TPS, is specified through the following controller option:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=o>{</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=w>    </span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>10</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>  </span><span class=o>}</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=o>}</span>
</span></code></pre></div> <h2 id=fixed-feedback-rate>Fixed feedback rate<a class=headerlink href=#fixed-feedback-rate title="Permanent link">&para;</a></h2> <p>The fixed feedback rate controller which is the extension of fixed rate also will originally send input transactions at a fixed interval. When the unfinished transactions exceeds times of the defined unfinished transactions for each client,it will stop sending input transactions temporally by sleeping a long period of time.</p> <p>Controller options include:</p> <ul> <li><code>tps</code>: the rate at which transactions are cumulatively sent to the SUT by all workers</li> <li><code>transactionLoad</code>: the maximum transaction load on the SUT at which workers will pause sending further transactions</li> </ul> <p>The fixed feedback rate controller, driving at 100 TPS, 100 unfinished transactions for each client, is specified through the following controller option:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=o>{</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-feedback-rate&quot;</span>,
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>      </span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>100</span>,
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>      </span><span class=s2>&quot;transactionLoad&quot;</span>:<span class=w> </span><span class=m>100</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>  </span><span class=o>}</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=o>}</span>
</span></code></pre></div> <h2 id=fixed-load>Fixed Load<a class=headerlink href=#fixed-load title="Permanent link">&para;</a></h2> <p>The fixed load rate controller is a controller for driving the tests at a target loading (backlog transactions). This controller will aim to maintain a defined backlog of transactions within the system by modifying the driven TPS. The result is the maximum possible TPS for the system whilst maintaining the pending transaction load.</p> <h3 id=options-and-use_1>Options and use<a class=headerlink href=#options-and-use_1 title="Permanent link">&para;</a></h3> <p>The fixed-load controller can be specified by setting the rate controller <code>type</code> to the <code>fixed-load</code> string.</p> <p>Controller options include:</p> <ul> <li><code>startTps</code>: the initial rate at which transactions are cumulatively sent to the SUT by all workers</li> <li><code>transactionLoad</code>: the number of transactions being processed by the SUT that is to be maintained</li> </ul> <p>The fixed load controller, aiming to maintain a SUT transaction load of 5, with a starting TPS of 100, is specified through the following controller option:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>{
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>  &quot;type&quot;: &quot;fixed-load&quot;,
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>  &quot;opts&quot;: {
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>    &quot;transactionLoad&quot;: 5,
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>    &quot;startTps&quot;: 100
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>  }
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>}
</span></code></pre></div> <h2 id=maximum-rate>Maximum rate<a class=headerlink href=#maximum-rate title="Permanent link">&para;</a></h2> <p>The maximum rate controller is a controller for driving the workers to their maximum achievable rate without overloading the SUT. This controller will aim to maximize the driven TPS for the worker by ramping up the driven TPS and backing off again when a drop in TPS is witnessed; such drops are indicative of an overloaded system.</p> <p>The achieved TPS is evaluated between txUpdate cycles, since this is the point at which TPS results are made available. A minimum sample interval that ensures settling of TPS rates should be considered for enhanced controller stability.</p> <p>Please note that the action of the controller is to slowly ramp to the maximum achievable rate for each worker until a threshold is reached, meaning that there will be a significant warm up phase that may skew averaged results for the round. It is recommended to investigate achievable results using Prometheus queries and/or Grafana visualization.</p> <h3 id=options-and-use_2>Options and use<a class=headerlink href=#options-and-use_2 title="Permanent link">&para;</a></h3> <p>The maximum rate controller can be specified by setting the rate controller <code>type</code> to the <code>maximum-rate</code> string.</p> <p>Controller options include:</p> <ul> <li><code>tps</code>: the starting TPS</li> <li><code>step</code>: the TPS increase for each interval. Note that on “back-off” this step size will automatically be reduced before re-attempting a TPS increase.</li> <li><code>sampleInterval</code>: the minimum time between steps to ensure settling of achieved TPS rates</li> <li><code>includeFailed</code>: boolean flag to indicate if the achieved TPS analysis within the controller is to include failed transactions (default true)</li> </ul> <p>The maximum rate controller, with a starting TPS of 100, a TPS step size of 5, and a minimum sample interval of 20seconds, is specified through the following controller option:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=o>{</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;maximum-rate&quot;</span>,
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=s2>&quot;tps&quot;</span>:<span class=w> </span><span class=m>100</span>,
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=s2>&quot;step&quot;</span>:<span class=w> </span><span class=m>5</span>,
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=s2>&quot;sampleInterval&quot;</span>:<span class=w> </span><span class=m>20</span>,
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=s2>&quot;includeFailed&quot;</span>:<span class=w> </span><span class=nb>true</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>  </span><span class=o>}</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=o>}</span>
</span></code></pre></div> <h2 id=linear-rate>Linear rate<a class=headerlink href=#linear-rate title="Permanent link">&para;</a></h2> <p>Exploring the performance limits of a system usually consists of performing multiple measurements with increasing load intensity. However, finding the tipping point of the system this way is not easy, it is more like a trial-and-error method.</p> <p>The linear rate controller can gradually (linearly) change the TPS rate between a starting and finishing TPS value (both in increasing and decreasing manner). This makes it easier to find the workload rates that affect the system performance in an interesting way.</p> <p>The linear rate controller can be used in both duration-based and transaction number-based rounds. </p> <h3 id=options-and-use_3>Options and use<a class=headerlink href=#options-and-use_3 title="Permanent link">&para;</a></h3> <p>The linear rate controller can be specified by setting the rate controller <code>type</code> to the <code>linear-rate</code> string.</p> <p>Controller options include:</p> <ul> <li><code>startingTps</code>: the rate at which transactions are cumulatively sent to the SUT by all workers at the start of the round</li> <li><code>finishingTps</code>: the rate at which transactions are cumulatively sent to the SUT by all workers at the end of the round</li> </ul> <p>The following example specifies a rate controller that gradually changes the transaction load from 25 TPS to 75 TPS during the benchmark round.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=o>{</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;linear-rate&quot;</span>,
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>    </span><span class=s2>&quot;startingTps&quot;</span>:<span class=w> </span><span class=m>25</span>,
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>    </span><span class=s2>&quot;finishingTps&quot;</span>:<span class=w> </span><span class=m>75</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=o>}</span>
</span></code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>similarly to the <a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#fixed-rate>fixed rate controller</a>, this controller also divides the workload between the available client, so the specified rates in the configuration are cumulative rates, and not the rates of individual clients. Using the above configuration with 5 clients results in clients that start at 5 TPS and finish at 15 TPS. Together they generate a [25-75] TPS load.</p> </div> <h2 id=composite-rate>Composite rate<a class=headerlink href=#composite-rate title="Permanent link">&para;</a></h2> <p>A benchmark round in Caliper is associated with a single rate controller. However, a single rate controller is rarely sufficient to model advanced client behaviors. Moreover, implementing new rate controllers for such behaviors can be cumbersome and error-prone. Most of the time a complex client behavior can be split into several, simpler phases.</p> <p>Accordingly, the composite rate controller enables the configuration of multiple “simpler” rate controllers in a single round, promoting the reusability of existing rate controller implementations. The composite rate controller will automatically switch between the given controllers according to the specified weights (see the configuration details after the example).</p> <h3 id=options-and-use_4>Options and use<a class=headerlink href=#options-and-use_4 title="Permanent link">&para;</a></h3> <p>The composite rate controller can be specified by setting the rate controller type to the composite-rate string.</p> <p>Controller options include:</p> <ul> <li><code>weights</code>: an array of “number-like” values (explicit numbers or numbers as strings) specifying the weights associated with the rate controllers defined in the <code>rateControllers</code> property.</li> </ul> <p>The weights do not necessarily have to sum to 1, since they will eventually be normalized to a vector of unit length. This means, that the weights can be specified in a manner that is the most intuitive for the given configuration. For example, the weights can correspond to durations, numbers of transactions or ratios.</p> <p>In the above example, the weights are corresponding to ratios (2:1:2). The exact meaning of the weights is determined by whether the benchmark round is duration-based or transaction number-based. If the above controller definition is used in a round with a duration of 5 minutes, then in the first 2 minutes the transactions will be submitted at 100 TPS, then at 300 TPS for the next minute, and at 200 TPS for the last 2 minutes of the round.</p> <p>Note, that 0 weights are also allowed in the array. Setting the weight of one or more controllers to 0 is a convenient way to “remove/disable” those controllers without actually removing them from the configuration file.</p> <ul> <li><code>rateControllers</code>: an array of arbitrary rate controller specifications. See the documentation of the individual rate controllers on how to configure them. The number of specified rate controllers must equal to the number of specified weights.</li> </ul> <p>Note, that technically, composite rate controllers can be nested to form a hierarchy. However, using a composite rate controller incurs an additional execution overhead in the rate control logic. Keep this in mind before specifying a deep hierarchy of composite rate controllers, or just flatten the hierarchy to a single level.</p> <ul> <li><code>logChange</code>: a boolean value indicating whether the switches between the specified rate controllers should be logged or not.</li> </ul> <p>For example, the definition of a square wave function (with varying amplitude) as the transaction submission rate is as easy as switching between <a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#fixed-rate>fixed rate</a> controllers with different TPS settings:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=o>{</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;composite-rate&quot;</span>,
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span><span class=s2>&quot;weights&quot;</span>:<span class=w> </span><span class=o>[</span><span class=m>2</span>,<span class=w> </span><span class=m>1</span>,<span class=w> </span><span class=m>2</span><span class=o>]</span>,
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=w>    </span><span class=s2>&quot;rateControllers&quot;</span>:<span class=w> </span><span class=o>[</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=w>      </span><span class=o>{</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=w>        </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=w>        </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>100</span><span class=o>}</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>      </span><span class=o>}</span>,
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>      </span><span class=o>{</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>        </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>        </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>300</span><span class=o>}</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>      </span><span class=o>}</span>,
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=w>      </span><span class=o>{</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>        </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>        </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>200</span><span class=o>}</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>      </span><span class=o>}</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>    </span><span class=o>]</span>,<span class=w>  </span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=w>    </span><span class=s2>&quot;logChange&quot;</span>:<span class=w> </span><span class=nb>true</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=w>  </span><span class=o>}</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=o>}</span>
</span></code></pre></div> <p><strong>Important!</strong> The existence of the composite rate controller is almost transparent to the specified “sub-controllers.” This is achieved by essentially placing the controllers in a “virtualized” round, i.e., “lying” to them about:</p> <ul> <li>the duration of the round (for duration-based rounds),</li> <li>the total number of transactions to submit (for transaction number-based rounds),</li> <li>the starting time of the round, and</li> <li>the index of the next transaction to submit.</li> </ul> <p>The results of recently finished transactions are propagated to the sub-controllers as-is, so for the first few call of a newly activated sub-controller it can receive recent results that don’t belong to its virtualized round.</p> <p>This virtualization does not affect the memoryless controllers, i.e., the controllers whose control logic does not depend on global round properties or past transaction results. However, other controllers might exhibit some strange (but hopefully transient) behavior due to this “virtualized” round approach. For example, the logic of the <a href=https://hyperledger.github.io/caliper/v0.5.0/reference/ate-controllers/#pid-rate>PID controller</a> for example depends on the transaction backlog.</p> <h2 id=zero-rate>Zero rate<a class=headerlink href=#zero-rate title="Permanent link">&para;</a></h2> <p>This controller stops the workload generation for the duration of the round. </p> <h3 id=options-and-use_5>Options and use<a class=headerlink href=#options-and-use_5 title="Permanent link">&para;</a></h3> <p>Using the controller on its own for a round is meaningless. However, it can be used as a building block inside a <a href=https://hyperledger.github.io/caliper/v0.5.0/reference/rate-controllers/#composite-rate>composite rate</a> controller. <strong>The zero rate controller can be used only in duration-based rounds!</strong></p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=o>{</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;composite-rate&quot;</span>,
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>    </span><span class=s2>&quot;weights&quot;</span>:<span class=w> </span><span class=o>[</span><span class=m>30</span>,<span class=w> </span><span class=m>10</span>,<span class=w> </span><span class=m>10</span>,<span class=w> </span><span class=m>30</span><span class=o>]</span>,
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>    </span><span class=s2>&quot;rateControllers&quot;</span>:<span class=w> </span><span class=o>[</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>      </span><span class=o>{</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>        </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>        </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>100</span><span class=o>}</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>      </span><span class=o>}</span>,
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>      </span><span class=o>{</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>        </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>        </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>500</span><span class=o>}</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>      </span><span class=o>}</span>,
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>      </span><span class=o>{</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>        </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;zero-rate&quot;</span>,
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>        </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=w> </span><span class=o>}</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>      </span><span class=o>}</span>,
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>      </span><span class=o>{</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>        </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>        </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>100</span><span class=o>}</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=w>      </span><span class=o>}</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=w>    </span><span class=o>]</span>,<span class=w>  </span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=w>    </span><span class=s2>&quot;logChange&quot;</span>:<span class=w> </span><span class=nb>true</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=w>  </span><span class=o>}</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=o>}</span>
</span></code></pre></div> <p>Let’s assume, that the above example is placed in a round definition with an 80 seconds duration (note the intuitive specification of the weights). In this case, an initial 30 seconds normal workload is followed by a 10 seconds intensive workload, which is followed by a 10 seconds <em>cooldown</em> period, etc.</p> <p>The controller is identified by the <code>zero-rate</code> string as the value of the <code>type</code> property and requires no additional configuration.</p> <h2 id=record-rate>Record rate<a class=headerlink href=#record-rate title="Permanent link">&para;</a></h2> <p>This rate controller serves as a decorator around an other (arbitrary) controller. Its purpose is to record the times (relative to the start of the round) when each transaction was submitted, i.e., when the transaction was “enabled” by the “sub-controller.”</p> <p>The following example records the times when the underlying <a href=https://hyperledger.github.io/caliper/v0.5.0/reference.rate-controllers/#fixed-rate>fixed rate</a> controller enabled the transactions (for details, see the available options below the example):</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=o>{</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;record-rate&quot;</span>,
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>    </span><span class=s2>&quot;rateController&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>      </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;fixed-rate&quot;</span>,
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>      </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span><span class=s2>&quot;tps&quot;</span><span class=w> </span>:<span class=w> </span><span class=m>100</span><span class=o>}</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>    </span><span class=o>}</span>,
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class=s2>&quot;pathTemplate&quot;</span>:<span class=w> </span><span class=s2>&quot;../tx_records_client&lt;C&gt;_round&lt;R&gt;.txt&quot;</span>,
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>    </span><span class=s2>&quot;outputFormat&quot;</span>:<span class=w> </span><span class=s2>&quot;TEXT&quot;</span>,
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>    </span><span class=s2>&quot;logEnd&quot;</span>:<span class=w> </span><span class=nb>true</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>  </span><span class=o>}</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=o>}</span>
</span></code></pre></div> <p>The record rate controller can be specified by setting the rate controller <code>type</code> to the <code>record-rate</code> string. The available options (<code>opts</code> property) are the following:</p> <ul> <li><code>rateController</code>: the specification of an arbitrary rate controller.</li> <li><code>pathTemplate</code>: the template for the file path where the recorded times will be saved. The path can be either an absolute path or relative to the root Caliper directory.</li> </ul> <p>The template can (<strong>and should</strong>) contain special “variables/placeholders” that can refer to special environment properties (see the remarks below). The available placeholders are the following: - <code>&lt;C&gt;</code>: placeholder for the 1-based index of the current client that uses this rate controller. - <code>&lt;R&gt;</code>: placeholder for the 1-based index of the current round that uses this rate controller.</p> <ul> <li><code>outputFormat</code>: optional. Determines the format in which the recording will be saved. Defaults to <code>"TEXT"</code>. The currently supported formats are the following:<ul> <li><code>"TEXT"</code>: each recorded timing is encoded as text on separate lines.</li> <li><code>"BIN_BE"</code>: binary format with Big Endian encoding.</li> <li><code>"BIN_LE"</code>: binary format with Little Endian encoding.</li> </ul> </li> <li><code>logEnd</code>: optional. Indicates whether to log that the recordings are written to the file(s). Defaults to <code>false</code>.</li> </ul> <p><strong>Template placeholders</strong>: since Caliper provides a concise way to define multiple rounds and multiple clients with the same behavior, it is essential to differentiate between the recordings of the clients and rounds. Accordingly, the output file paths can contain placeholders for the round and client indices that will be resolved automatically at each client in each round. Otherwise, every client would write the same file, resulting in a serious conflict between timings and transaction IDs.</p> <p><strong>Text format</strong>: the rate controller saves the recordings in the following format (assuming a constant 10 TPS rate and ignoring the noise in the actual timings), row <code>i</code> corresponding to the <code>i</code>th transaction:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=m>100</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=m>200</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=m>300</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>...
</span></code></pre></div> <p><strong>Binary format</strong>: Both binary representations encode the <code>X</code> number of recordings as a series of <code>X+1</code> UInt32 numbers (1 number for the array length, the rest for the array elements), either in Little Endian or Big Endian encoding:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>Offset:<span class=w> </span><span class=p>|</span><span class=m>0</span><span class=w>      </span><span class=p>|</span><span class=m>4</span><span class=w>      </span><span class=p>|</span><span class=m>8</span><span class=w>      </span><span class=p>|</span><span class=m>12</span><span class=w>      </span><span class=p>|</span><span class=m>16</span><span class=w>      </span><span class=p>|</span>...<span class=w>     </span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>Data:<span class=w>   </span><span class=p>|</span>length<span class=w> </span><span class=p>|</span>1st<span class=w>    </span><span class=p>|</span>2nd<span class=w>    </span><span class=p>|</span>3rd<span class=w>     </span><span class=p>|</span>4th<span class=w>     </span><span class=p>|</span>...<span class=w>      </span>
</span></code></pre></div> <h2 id=replay-rate>Replay rate<a class=headerlink href=#replay-rate title="Permanent link">&para;</a></h2> <p>One of the most important aspect of a good benchmark is its repeatability, i.e., it can be re-executed in a deterministic way whenever necessary. However, some benchmarks define the workload (e.g., user behavior) as a function of probabilistic distribution(s). This presents two problems from a practical point of view:</p> <ol> <li>Repeatability: The random sampling of the given probability distribution(s) can differ between benchmark (re-)executions. This makes the comparison of different platforms questionable.</li> <li>Efficiency: Sampling a complex probability distribution incurs an additional runtime overhead, which can limit the rate of the load, distorting the originally specified workload.</li> </ol> <p>This rate controller aims to mitigate these problems by replaying a fix transaction load profile that was created “offline.” This way the profile is generated once, outside of the benchmark execution, and can be replayed any time with the same timing constraints with minimal overhead.</p> <p>A trivial use case of this controller is to play back a transaction recording created by the record controller. However, a well-formed trace file is the only requirement for this controller, hence any tool/method can be used to generate the transaction load profile.</p> <p>The following example specifies a rate controller that replays some client-dependent workload profiles (for details, see the available options below the example):</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=o>{</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>  </span><span class=s2>&quot;type&quot;</span>:<span class=w> </span><span class=s2>&quot;replay-rate&quot;</span>,
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>  </span><span class=s2>&quot;opts&quot;</span>:<span class=w> </span><span class=o>{</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>    </span><span class=s2>&quot;pathTemplate&quot;</span>:<span class=w> </span><span class=s2>&quot;../tx_records_client&lt;C&gt;.txt&quot;</span>,
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>    </span><span class=s2>&quot;inputFormat&quot;</span>:<span class=w> </span><span class=s2>&quot;TEXT&quot;</span>,
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>    </span><span class=s2>&quot;logWarnings&quot;</span>:<span class=w> </span>true,
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>    </span><span class=s2>&quot;defaultSleepTime&quot;</span>:<span class=w> </span><span class=m>50</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=o>}</span>
</span></code></pre></div> <p>The replay rate controller can be specified by setting the rate controller type to the <code>replay-rate</code> string. The available options (<code>opts</code> property) are the following:</p> <ul> <li><code>pathTemplate</code>: the template for the file path where the transaction timings will be replayed from. The path can be either an absolute path or relative to the root Caliper directory.</li> </ul> <p>The template can (<strong>and should</strong>) contain special “variables/placeholders” that can refer to special environment properties (see the remarks at the <a href=https://hyperledger.github.io/caliper/v0.5.0/reference.rate-controllers/#record-rate>record rate controller</a>). The available placeholders are the following: - <code>&lt;C&gt;</code>: placeholder for the 1-based index of the current client that uses this rate controller. - <code>&lt;R&gt;</code>: placeholder for the 1-based index of the current round that uses this rate controller.</p> <ul> <li><code>inputFormat</code>: optional. Determines the format in which the transaction timings are stored (see the details at the <a href=https://hyperledger.github.io/caliper/v0.5.0/reference.rate-controllers/#record-rate>record rate controller</a>). Defaults to <code>"TEXT"</code>. The currently supported formats are the following:<ul> <li><code>"TEXT"</code>: each recorded timing is encoded as text on separate lines.</li> <li><code>"BIN_BE"</code>: binary format with Big Endian encoding.</li> <li><code>"BIN_LE"</code>: binary format with Little Endian encoding.</li> </ul> </li> <li><code>logWarnings</code>: optional. Indicates whether to log that there are no more recordings to replay, so the <code>defaultSleepTime</code> is used between consecutive transactions. Defaults to <code>false</code>.</li> <li><code>defaultSleepTime</code>: optional. Determines the sleep time between transactions for the case when the benchmark execution is longer than the specified recording. Defaults to <code>20</code> ms.</li> </ul> <h3 id=about-the-recordings>About the recordings:<a class=headerlink href=#about-the-recordings title="Permanent link">&para;</a></h3> <p>Special care must be taken, when using duration-based benchmark execution, as it is possible to issue more transactions than specified in the recording. A safety measure for this case is the <code>defaultSleepTime</code> option. This should only occur in the last few moments of the execution, affecting only a few transactions, that can be discarded before performing additional performance analyses on the results.</p> <p>The recommended approach is to use transaction number-based round configurations, since the number of transactions to replay is known beforehand. Note, that the number of clients affects the actual number of transactions submitted by a client.</p> <h2 id=adding-custom-controllers>Adding Custom Controllers<a class=headerlink href=#adding-custom-controllers title="Permanent link">&para;</a></h2> <p>It is possible to use rate controllers that are not built-in controllers of Caliper. When you specify the rate controller in the test configuration file (see the <a href=https://hyperledger.github.io/caliper/v0.5.0/overview/architecture/ >architecture documentation</a>), you must set the <code>type</code> and <code>opts</code> attributes.</p> <p>You can set the <code>type</code> attribute so that it points to your custom JS file that satisfies the following criteria:</p> <ol> <li> <p>The file/module exports a <code>createRateController</code> function that takes the following parameters:</p> <ol> <li>An <code>TestMessage</code> parameter that is the <code>object</code> representation of the <code>opts</code> attribute set in the configuration file, and contains the custom settings of your rate controller.</li> <li>A <code>TransactionStatisticsCollector</code> object that gives the rate controller access to the current worker transaction statistics</li> <li>A <code>workerIndex</code> parameter of type number that is the 0-based index of the worker process using this rate controller. The function must return an object (i.e., your rate controller instance) that satisfies the next criteria.</li> </ol> </li> <li> <p>The object returned by <code>createRateController</code> must implement the <code>/packages/caliper-core/lib/rate-control/rateInterface.js</code> interface, i.e., must provide the following async functions:</p> </li> <li>applyRateControl , for performing the actual rate control by “blocking” the execution (in an async manner) for the desired time.</li> <li><code>end</code>, for disposing any acquired resources at the end of a round.</li> </ol> <p>The following example is a complete implementation of a rate control that doesn’t perform any control, thus allowing the submitting of transactions as fast as the program execution allows it (warning, this implementation run with many client processes could easily over-load a backend network, so use it with caution).</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>/*
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>*<span class=w> </span>Licensed<span class=w> </span>under<span class=w> </span>the<span class=w> </span>Apache<span class=w> </span>License,<span class=w> </span>Version<span class=w> </span><span class=m>2</span>.0<span class=w> </span><span class=o>(</span>the<span class=w> </span><span class=s2>&quot;License&quot;</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>*<span class=w> </span>you<span class=w> </span>may<span class=w> </span>not<span class=w> </span>use<span class=w> </span>this<span class=w> </span>file<span class=w> </span>except<span class=w> </span><span class=k>in</span><span class=w> </span>compliance<span class=w> </span>with<span class=w> </span>the<span class=w> </span>License.
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>*<span class=w> </span>You<span class=w> </span>may<span class=w> </span>obtain<span class=w> </span>a<span class=w> </span>copy<span class=w> </span>of<span class=w> </span>the<span class=w> </span>License<span class=w> </span>at
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>*
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>*<span class=w> </span>http://www.apache.org/licenses/LICENSE-2.0
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>*
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>*<span class=w> </span>Unless<span class=w> </span>required<span class=w> </span>by<span class=w> </span>applicable<span class=w> </span>law<span class=w> </span>or<span class=w> </span>agreed<span class=w> </span>to<span class=w> </span><span class=k>in</span><span class=w> </span>writing,<span class=w> </span>software
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>*<span class=w> </span>distributed<span class=w> </span>under<span class=w> </span>the<span class=w> </span>License<span class=w> </span>is<span class=w> </span>distributed<span class=w> </span>on<span class=w> </span>an<span class=w> </span><span class=s2>&quot;AS IS&quot;</span><span class=w> </span>BASIS,
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>*<span class=w> </span>WITHOUT<span class=w> </span>WARRANTIES<span class=w> </span>OR<span class=w> </span>CONDITIONS<span class=w> </span>OF<span class=w> </span>ANY<span class=w> </span>KIND,<span class=w> </span>either<span class=w> </span>express<span class=w> </span>or<span class=w> </span>implied.
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a>*<span class=w> </span>See<span class=w> </span>the<span class=w> </span>License<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>specific<span class=w> </span>language<span class=w> </span>governing<span class=w> </span>permissions<span class=w> </span>and
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>*<span class=w> </span>limitations<span class=w> </span>under<span class=w> </span>the<span class=w> </span>License.
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>*/
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>const<span class=w> </span><span class=nv>RateInterface</span><span class=w> </span><span class=o>=</span><span class=w> </span>require<span class=o>(</span><span class=s1>&#39;path-to-caliper/caliper-core/lib/rate-control/rateInterface.js&#39;</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>/**
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=w> </span>*<span class=w> </span>Rate<span class=w> </span>controller<span class=w> </span><span class=k>for</span><span class=w> </span>allowing<span class=w> </span>uninterrupted<span class=w> </span>workloadload<span class=w> </span>generation.
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w> </span>*
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=w> </span>*<span class=w> </span>@property<span class=w> </span><span class=o>{</span>object<span class=o>}</span><span class=w> </span>options<span class=w> </span>The<span class=w> </span>user-supplied<span class=w> </span>options<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>controller.<span class=w> </span>Empty.
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a><span class=w> </span>*/
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>class<span class=w> </span>MaxRateController<span class=w> </span>extends<span class=w> </span>RateInterface<span class=o>{</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=w>    </span>/**
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=w>     </span>*<span class=w> </span>Creates<span class=w> </span>a<span class=w> </span>new<span class=w> </span>instance<span class=w> </span>of<span class=w> </span>the<span class=w> </span>MaxRateController<span class=w> </span>class.
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=w>     </span>*<span class=w> </span>@constructor
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>}</span><span class=w> </span>opts<span class=w> </span>Options<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>rate<span class=w> </span>controller.<span class=w> </span>Empty.
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=w>     </span>*/
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=w>    </span>constructor<span class=o>(</span>opts<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a><span class=w>        </span>//<span class=w> </span>just<span class=w> </span>pass<span class=w> </span>it<span class=w> </span>to<span class=w> </span>the<span class=w> </span>base<span class=w> </span>class
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=w>        </span>super<span class=o>(</span>opts<span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a>
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=w>    </span>/**
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a><span class=w>     </span>*<span class=w> </span>Initializes<span class=w> </span>the<span class=w> </span>rate<span class=w> </span>controller.
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a><span class=w>     </span>*
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>}</span><span class=w> </span>msg<span class=w> </span>Client<span class=w> </span>options<span class=w> </span>with<span class=w> </span>adjusted<span class=w> </span>per-client<span class=w> </span>load<span class=w> </span>settings.
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>string<span class=o>}</span><span class=w> </span>msg.type<span class=w> </span>The<span class=w> </span><span class=nb>type</span><span class=w> </span>of<span class=w> </span>the<span class=w> </span>message.<span class=w> </span>Currently<span class=w> </span>always<span class=w> </span><span class=s1>&#39;test&#39;</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>string<span class=o>}</span><span class=w> </span>msg.label<span class=w> </span>The<span class=w> </span>label<span class=w> </span>of<span class=w> </span>the<span class=w> </span>round.
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>}</span><span class=w> </span>msg.rateControl<span class=w> </span>The<span class=w> </span>rate<span class=w> </span>control<span class=w> </span>to<span class=w> </span>use<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>round.
</span><span id=__span-11-42><a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>msg.trim<span class=w> </span>The<span class=w> </span>number/seconds<span class=w> </span>of<span class=w> </span>transactions<span class=w> </span>to<span class=w> </span>trim<span class=w> </span>from<span class=w> </span>the<span class=w> </span>results.
</span><span id=__span-11-43><a id=__codelineno-11-43 name=__codelineno-11-43 href=#__codelineno-11-43></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>}</span><span class=w> </span>msg.args<span class=w> </span>The<span class=w> </span>user<span class=w> </span>supplied<span class=w> </span>arguments<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>round.
</span><span id=__span-11-44><a id=__codelineno-11-44 name=__codelineno-11-44 href=#__codelineno-11-44></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>string<span class=o>}</span><span class=w> </span>msg.cb<span class=w> </span>The<span class=w> </span>path<span class=w> </span>of<span class=w> </span>the<span class=w> </span>user<span class=s1>&#39;s callback module.</span>
</span><span id=__span-11-45><a id=__codelineno-11-45 name=__codelineno-11-45 href=#__codelineno-11-45></a><span class=s1>     * @param {string} msg.config The path of the network&#39;</span>s<span class=w> </span>configuration<span class=w> </span>file.
</span><span id=__span-11-46><a id=__codelineno-11-46 name=__codelineno-11-46 href=#__codelineno-11-46></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>msg.numb<span class=w> </span>The<span class=w> </span>number<span class=w> </span>of<span class=w> </span>transactions<span class=w> </span>to<span class=w> </span>generate<span class=w> </span>during<span class=w> </span>the<span class=w> </span>round.
</span><span id=__span-11-47><a id=__codelineno-11-47 name=__codelineno-11-47 href=#__codelineno-11-47></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>msg.txDuration<span class=w> </span>The<span class=w> </span>length<span class=w> </span>of<span class=w> </span>the<span class=w> </span>round<span class=w> </span><span class=k>in</span><span class=w> </span>SECONDS.
</span><span id=__span-11-48><a id=__codelineno-11-48 name=__codelineno-11-48 href=#__codelineno-11-48></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>msg.totalClients<span class=w> </span>The<span class=w> </span>number<span class=w> </span>of<span class=w> </span>clients<span class=w> </span>executing<span class=w> </span>the<span class=w> </span>round.
</span><span id=__span-11-49><a id=__codelineno-11-49 name=__codelineno-11-49 href=#__codelineno-11-49></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>msg.clients<span class=w> </span>The<span class=w> </span>number<span class=w> </span>of<span class=w> </span>clients<span class=w> </span>executing<span class=w> </span>the<span class=w> </span>round.
</span><span id=__span-11-50><a id=__codelineno-11-50 name=__codelineno-11-50 href=#__codelineno-11-50></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>}</span><span class=w> </span>msg.clientargs<span class=w> </span>Arguments<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>client.
</span><span id=__span-11-51><a id=__codelineno-11-51 name=__codelineno-11-51 href=#__codelineno-11-51></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>msg.clientIdx<span class=w> </span>The<span class=w> </span><span class=m>0</span>-based<span class=w> </span>index<span class=w> </span>of<span class=w> </span>the<span class=w> </span>current<span class=w> </span>client.
</span><span id=__span-11-52><a id=__codelineno-11-52 name=__codelineno-11-52 href=#__codelineno-11-52></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>msg.roundIdx<span class=w> </span>The<span class=w> </span><span class=m>1</span>-based<span class=w> </span>index<span class=w> </span>of<span class=w> </span>the<span class=w> </span>current<span class=w> </span>round.
</span><span id=__span-11-53><a id=__codelineno-11-53 name=__codelineno-11-53 href=#__codelineno-11-53></a><span class=w>     </span>*<span class=w> </span>@async
</span><span id=__span-11-54><a id=__codelineno-11-54 name=__codelineno-11-54 href=#__codelineno-11-54></a><span class=w>     </span>*/
</span><span id=__span-11-55><a id=__codelineno-11-55 name=__codelineno-11-55 href=#__codelineno-11-55></a><span class=w>    </span>async<span class=w> </span>init<span class=o>(</span>msg<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-56><a id=__codelineno-11-56 name=__codelineno-11-56 href=#__codelineno-11-56></a><span class=w>        </span>//<span class=w> </span>no<span class=w> </span>init<span class=w> </span>is<span class=w> </span>needed
</span><span id=__span-11-57><a id=__codelineno-11-57 name=__codelineno-11-57 href=#__codelineno-11-57></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-58><a id=__codelineno-11-58 name=__codelineno-11-58 href=#__codelineno-11-58></a>
</span><span id=__span-11-59><a id=__codelineno-11-59 name=__codelineno-11-59 href=#__codelineno-11-59></a><span class=w>    </span>/**
</span><span id=__span-11-60><a id=__codelineno-11-60 name=__codelineno-11-60 href=#__codelineno-11-60></a><span class=w>     </span>*<span class=w> </span>Doesn<span class=err>&#39;</span>t<span class=w> </span>perform<span class=w> </span>any<span class=w> </span>rate<span class=w> </span>control.
</span><span id=__span-11-61><a id=__codelineno-11-61 name=__codelineno-11-61 href=#__codelineno-11-61></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>start<span class=w> </span>The<span class=w> </span>epoch<span class=w> </span><span class=nb>time</span><span class=w> </span>at<span class=w> </span>the<span class=w> </span>start<span class=w> </span>of<span class=w> </span>the<span class=w> </span>round<span class=w> </span><span class=o>(</span>ms<span class=w> </span>precision<span class=o>)</span>.
</span><span id=__span-11-62><a id=__codelineno-11-62 name=__codelineno-11-62 href=#__codelineno-11-62></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>idx<span class=w> </span>Sequence<span class=w> </span>number<span class=w> </span>of<span class=w> </span>the<span class=w> </span>current<span class=w> </span>transaction.
</span><span id=__span-11-63><a id=__codelineno-11-63 name=__codelineno-11-63 href=#__codelineno-11-63></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>[]}</span><span class=w> </span>recentResults<span class=w> </span>The<span class=w> </span>list<span class=w> </span>of<span class=w> </span>results<span class=w> </span>of<span class=w> </span>recent<span class=w> </span>transactions.
</span><span id=__span-11-64><a id=__codelineno-11-64 name=__codelineno-11-64 href=#__codelineno-11-64></a><span class=w>     </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>[]}</span><span class=w> </span>resultStats<span class=w> </span>The<span class=w> </span>aggregated<span class=w> </span>stats<span class=w> </span>of<span class=w> </span>previous<span class=w> </span>results.
</span><span id=__span-11-65><a id=__codelineno-11-65 name=__codelineno-11-65 href=#__codelineno-11-65></a><span class=w>     </span>*<span class=w> </span>@async
</span><span id=__span-11-66><a id=__codelineno-11-66 name=__codelineno-11-66 href=#__codelineno-11-66></a><span class=w>     </span>*/
</span><span id=__span-11-67><a id=__codelineno-11-67 name=__codelineno-11-67 href=#__codelineno-11-67></a><span class=w>    </span>async<span class=w> </span>applyRateControl<span class=o>(</span>start,<span class=w> </span>idx,<span class=w> </span>recentResults,<span class=w> </span>resultStats<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-68><a id=__codelineno-11-68 name=__codelineno-11-68 href=#__codelineno-11-68></a><span class=w>        </span>//<span class=w> </span>no<span class=w> </span>sleeping<span class=w> </span>is<span class=w> </span>needed,<span class=w> </span>allow<span class=w> </span>the<span class=w> </span>transaction<span class=w> </span>invocation<span class=w> </span>immediately
</span><span id=__span-11-69><a id=__codelineno-11-69 name=__codelineno-11-69 href=#__codelineno-11-69></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-70><a id=__codelineno-11-70 name=__codelineno-11-70 href=#__codelineno-11-70></a>
</span><span id=__span-11-71><a id=__codelineno-11-71 name=__codelineno-11-71 href=#__codelineno-11-71></a><span class=w>    </span>/**
</span><span id=__span-11-72><a id=__codelineno-11-72 name=__codelineno-11-72 href=#__codelineno-11-72></a><span class=w>     </span>*<span class=w> </span>Notify<span class=w> </span>the<span class=w> </span>rate<span class=w> </span>controller<span class=w> </span>about<span class=w> </span>the<span class=w> </span>end<span class=w> </span>of<span class=w> </span>the<span class=w> </span>round.
</span><span id=__span-11-73><a id=__codelineno-11-73 name=__codelineno-11-73 href=#__codelineno-11-73></a><span class=w>     </span>*<span class=w> </span>@async
</span><span id=__span-11-74><a id=__codelineno-11-74 name=__codelineno-11-74 href=#__codelineno-11-74></a><span class=w>     </span>*/
</span><span id=__span-11-75><a id=__codelineno-11-75 name=__codelineno-11-75 href=#__codelineno-11-75></a><span class=w>    </span>async<span class=w> </span>end<span class=o>()</span><span class=w> </span><span class=o>{</span><span class=w> </span>
</span><span id=__span-11-76><a id=__codelineno-11-76 name=__codelineno-11-76 href=#__codelineno-11-76></a><span class=w>        </span>//<span class=w> </span>nothing<span class=w> </span>to<span class=w> </span>dispose<span class=w> </span>of
</span><span id=__span-11-77><a id=__codelineno-11-77 name=__codelineno-11-77 href=#__codelineno-11-77></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-78><a id=__codelineno-11-78 name=__codelineno-11-78 href=#__codelineno-11-78></a><span class=o>}</span>
</span><span id=__span-11-79><a id=__codelineno-11-79 name=__codelineno-11-79 href=#__codelineno-11-79></a>
</span><span id=__span-11-80><a id=__codelineno-11-80 name=__codelineno-11-80 href=#__codelineno-11-80></a>/**
</span><span id=__span-11-81><a id=__codelineno-11-81 name=__codelineno-11-81 href=#__codelineno-11-81></a><span class=w> </span>*<span class=w> </span>Creates<span class=w> </span>a<span class=w> </span>new<span class=w> </span>rate<span class=w> </span>controller<span class=w> </span>instance.
</span><span id=__span-11-82><a id=__codelineno-11-82 name=__codelineno-11-82 href=#__codelineno-11-82></a><span class=w> </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>object<span class=o>}</span><span class=w> </span>opts<span class=w> </span>The<span class=w> </span>rate<span class=w> </span>controller<span class=w> </span>options.
</span><span id=__span-11-83><a id=__codelineno-11-83 name=__codelineno-11-83 href=#__codelineno-11-83></a><span class=w> </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>clientIdx<span class=w> </span>The<span class=w> </span><span class=m>0</span>-based<span class=w> </span>index<span class=w> </span>of<span class=w> </span>the<span class=w> </span>client<span class=w> </span>who<span class=w> </span>instantiates<span class=w> </span>the<span class=w> </span>controller.
</span><span id=__span-11-84><a id=__codelineno-11-84 name=__codelineno-11-84 href=#__codelineno-11-84></a><span class=w> </span>*<span class=w> </span>@param<span class=w> </span><span class=o>{</span>number<span class=o>}</span><span class=w> </span>roundIdx<span class=w> </span>The<span class=w> </span><span class=m>1</span>-based<span class=w> </span>index<span class=w> </span>of<span class=w> </span>the<span class=w> </span>round<span class=w> </span>the<span class=w> </span>controller<span class=w> </span>is<span class=w> </span>instantiated<span class=w> </span><span class=k>in</span>.
</span><span id=__span-11-85><a id=__codelineno-11-85 name=__codelineno-11-85 href=#__codelineno-11-85></a><span class=w> </span>*<span class=w> </span>@return<span class=w> </span><span class=o>{</span>RateInterface<span class=o>}</span><span class=w> </span>The<span class=w> </span>rate<span class=w> </span>controller<span class=w> </span>instance.
</span><span id=__span-11-86><a id=__codelineno-11-86 name=__codelineno-11-86 href=#__codelineno-11-86></a><span class=w> </span>*/
</span><span id=__span-11-87><a id=__codelineno-11-87 name=__codelineno-11-87 href=#__codelineno-11-87></a><span class=k>function</span><span class=w> </span>createRateController<span class=o>(</span>opts,<span class=w> </span>clientIdx,<span class=w> </span>roundIdx<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-88><a id=__codelineno-11-88 name=__codelineno-11-88 href=#__codelineno-11-88></a><span class=w>    </span>//<span class=w> </span>no<span class=w> </span>need<span class=w> </span><span class=k>for</span><span class=w> </span>the<span class=w> </span>other<span class=w> </span>parameters
</span><span id=__span-11-89><a id=__codelineno-11-89 name=__codelineno-11-89 href=#__codelineno-11-89></a><span class=w>    </span><span class=k>return</span><span class=w> </span>new<span class=w> </span>MaxRateController<span class=o>(</span>opts<span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-90><a id=__codelineno-11-90 name=__codelineno-11-90 href=#__codelineno-11-90></a><span class=o>}</span>
</span><span id=__span-11-91><a id=__codelineno-11-91 name=__codelineno-11-91 href=#__codelineno-11-91></a>
</span><span id=__span-11-92><a id=__codelineno-11-92 name=__codelineno-11-92 href=#__codelineno-11-92></a>module.exports.createRateController<span class=w> </span><span class=o>=</span><span class=w> </span>createRateController<span class=p>;</span>
</span></code></pre></div> <p>Let’s say you save this implementation into a file called <code>maxRateController.js</code> next to your Caliper directory (so they’re on the same level). In the test configuration file you can set this rate controller (at its required place in the configuration hierarchy) the following way:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>rateControl:
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>  </span><span class=c1># relative path from the Caliper directory</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>-<span class=w> </span>type:<span class=w> </span>../maxRateController.js
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>  </span><span class=c1># empty options</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>  </span>opts:<span class=w> </span>
</span></code></pre></div> <h2 id=license>License<a class=headerlink href=#license title="Permanent link">&para;</a></h2> <p>The Caliper codebase is released under the <a href=https://hyperledger.github.io/caliper/v0.5.0/general/license/ >Apache 2.0 license</a>. Any documentation developed by the Caliper Project is licensed under the Creative Commons Attribution 4.0 International License. You may obtain a copy of the license, titled CC-BY-4.0, at <a href=http://creativecommons.org/licenses/by/4.0/ >http://creativecommons.org/licenses/by/4.0/</a>.</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../declarative-workload-module/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Declarative Workloads"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Declarative Workloads </div> </div> </a> <a href=../caliper-monitors/ class="md-footer__link md-footer__link--next" aria-label="Next: Resource and Transaction Monitors"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Resource and Transaction Monitors </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.fe8b6f2b.min.js></script> </body> </html>